<!DOCTYPE html>
<html>
<body>

<h1>{{finca.nombre}}</h1>
<h1>{{coordenadas}}</h1>
<h1 id="selected">Seleccionado</h1>
<canvas id="myCanvas" style="border:1px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.</canvas>

<script>

    
    var jsonContext = "{{coordenadas}}".replace(/(&quot\;)/g,"\"");
    var json = JSON.parse(jsonContext);
            
  

    var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    ctx.canvas.width = 500;
    ctx.canvas.height = 500;
    for (var i = 1; i <=4; i++) {
        ctx.fillRect(json["coordenada"+i].x, json["coordenada"+i].y, json["coordenada"+i].w, json["coordenada"+i].h);
        ctx.stroke();
    }
    var posx;
    var posy;
    c.addEventListener("click",handleClick);

    function getMousePos(c,evt){
    	var rect = c.getBoundingClientRect();
    	return {
    		x: evt.clientX,
        	y: evt.clientY
    	}
    }

    function handleClick(e){

    	var pos = getMousePos(c,e);
        var canva = c.getBoundingClientRect();
        posx = pos.x - canva.left;
        posy = pos.y - canva.top;

        for (var i = 1; i <=4; i++) {
            var x = json["coordenada"+i].x;
            var y = json["coordenada"+i].y;
            var w = json["coordenada"+i].w;
            var h = json["coordenada"+i].h;
            if(posx<=x+w&&posx>=x&&posy<=y+h&&posy>=y){
             document.getElementById("selected").innerHTML = "cuadro"+i;
                 var win = window.open("http://127.0.0.1:8000/admin/lote/lote/"+(i+2)+"/change/", '_blank');
                win.focus();
             
            }

        }

       
        
      
    }

</script> 

</body>
</html>